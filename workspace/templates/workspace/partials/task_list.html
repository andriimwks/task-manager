{% for task in tasks %}
    <tr class="animate__animated animate__zoomIn animate__faster" data-task-id="{{ task.pk }}">
        <td>
            {% if task.completed %}
                <span class="text-success">
                    <i class="fa-solid fa-check-double"></i>
                </span>
            {% else %}
                {% if task.priority == 0 %}
                    <span class="text-secondary">
                        <i class="fa-solid fa-angle-down"></i>
                    </span>
                {% elif task.priority == 1 %}
                    <span class="text-primary">
                        <i class="fa-solid fa-minus"></i>
                    </span>
                {% elif task.priority == 2 %}
                    <span class="text-warning">
                        <i class="fa-solid fa-angle-up"></i>
                    </span>
                {% elif task.priority == 3 %}
                    <span class="text-danger">
                        <i class="fa-solid fa-angles-up"></i>
                    </span>
                {% else %}
                    <span class="text-secondary">
                        <i class="fa-solid fa-question"></i>
                    </span>
                {% endif %}
            {% endif %}
        </td>
        <td x-data="{ loading: false }">
            <input
                x-show.important="!loading"
                type="checkbox"
                class="form-check-input"
                id="completed"
                name="completed"
                x-on:change="loading = true"
                hx-post="{% url 'workspace:complete_task' task.pk %}"
                hx-target="#task-container-{{ task.project.pk }}"
                hx-trigger="change delay:250ms"
                hx-swap="innerHTML"
                {% if task.completed %} checked {% endif %}
            >
            <span x-show.important="loading">
                <i class="fa-solid fa-spinner"></i>
            </span>
        </td>
        <td>
            <span class="fw-semibold">{{ task.name }}</span>
            {% if task.deadline and not task.completed %}
                <small class="d-block {% if task.is_overdue %} text-danger {% endif %}">
                    <i class="fa-solid fa-alarm-clock"></i>
                    {{ task.deadline|date:'d.m.Y' }}
                    <span class="d-none d-lg-inline">({{ task.days_remaining }} day{{ task.days_remaining|pluralize }} left)</span>
                </small>
            {% endif %}
        </td>
        <td>
            <div class="d-flex">
                <a class="btn btn-sm btn-link link-body-emphasis" href="{% url 'workspace:update_task' task.pk %}" hx-boost="true">
                    <i class="fa-solid fa-pen-to-square"></i>
                </a>

                <div class="vr"></div>

                <button
                    type="button"
                    class="btn btn-sm btn-link text-danger"
                    hx-delete="{% url 'workspace:delete_task' task.pk %}"
                    hx-target="[data-task-id='{{ task.pk }}']"
                    hx-swap="delete"
                >
                    <i class="fa-solid fa-trash-can"></i>
                </button>
            </div>
        </td>
    </tr>
{% endfor %}
